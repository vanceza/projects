#!/bin/sh
cd $(dirname "$0")
for file in project-*.sh
do
    source "./${file}"
done
cd - >/dev/null

export PROJECTS_HOME="${HOME}"
[ -z "${XDG_DATA_HOME}" ] || XDG_CACHE_HOME="$HOME/.local/share"
export PROJECTS_ARCHIVE_DIR="${XDG_DATA_HOME}/projects"
[ -z "${XDG_CONFIG_HOME}" ] || XDG_CONFIG_HOME="$HOME/.config"
export PROJECTS_METADATA_DIR="${XDG_CONFIG_HOME}/projects"
export PROJECTS="${PROJECTS_METADATA_DIR}/PROJECTS"

if [ $# -eq 0 ]
then
    project_help
    exit $?
fi

COMMAND="$1"
COMMAND="$(echo "$COMMAND" | tr '-' '_')" # Replace - with _ in COMMAND
shift
if type "project_${COMMAND}" 2>/dev/null | grep -i function >/dev/null
then
    "project_${COMMAND}" "$@"
    exit $?
else
    echo "Not a valid subcommand: ${COMMAND}" >/dev/stderr
    project_help
    exit 1
fi
